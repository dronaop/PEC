<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>GrowBot</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f3f0f0;
      color: #333;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    header {
      color: rgb(0, 0, 0);
      padding: 20px;
      font-weight: bold;
      text-align: center;
      font-size: 2.5rem;
      letter-spacing: 1px;
    }

    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 20px;
      padding: 40px;
      align-items: center;
    }

    .input-row {
      width: 90%;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      flex-wrap: wrap;
      gap: 30px;
      margin-bottom: 20px;
    }

    .input-group {
      display: flex;
      flex-direction: column;
      min-width: 100px;
    }

    label {
      font-size: 1.1rem;
      margin-bottom: 6px;
    }

    input {
      padding: 10px;
      font-size: 0.8rem;
      border: none;
      border-radius: 6px;
      outline: none;
      background: #ffffff;
    }

    button {
      margin: 10px auto 0;
      padding: 12px 24px;
      background: none;
      border: 2px solid #000000;
      color: #000000;
      font-size: 1.1rem;
      border-radius: 25px;
      cursor: pointer;
      transition: background 0.3s ease-in-out, color 0.3s ease-in-out;
      display: block;
    }

    button:hover {
      background-color: #000000;
      color: white;
    }

    .result-area {
      margin: 20px auto;
      width: 90%;
      max-width: 800px;
      padding: 20px;
      background-color: #ffffff;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      text-align: center;
      font-size: 1.2rem;
      color: #555;
    }

    @media (max-width: 1200px) {
      .input-row {
        flex-wrap: wrap;
      }
    }

    @media (max-width: 768px) {
      .input-group {
        min-width: 100%;
      }
    }
  </style>
</head>
<body>

<header>GrowBot</header>

<main>
  <!-- 5 input rows for 5 timesteps -->
  <!-- Row 1 -->
  <div class="input-row">
    <div class="input-group">
      <label for="ambientTemp1">Ambient Temperature (°C)</label>
      <input type="number" class="ambientTemp1" value="22.24" placeholder="Enter ambient temperature">
    </div>
    <div class="input-group">
      <label for="soilTemp1">Soil Temperature (°C)</label>
      <input type="number" class="soilTemp1" value="21.90" placeholder="Enter soil temperature">
    </div>
    <div class="input-group">
      <label for="humidity1">Humidity (%)</label>
      <input type="number" class="humidity1" value="55.29" placeholder="Enter humidity">
    </div>
    <div class="input-group">
      <label for="lightIntensity1">Light Intensity</label>
      <input type="number" class="lightIntensity1" value="556.17" placeholder="Enter light intensity">
    </div>
    <div class="input-group">
      <label for="chlorophyll1">Chlorophyll Content</label>
      <input type="number" class="chlorophyll1" value="35.70" placeholder="Enter Chlorophyll content">
    </div>
    <div class="input-group">
      <label for="electroSignal1">Electrochemical Signal</label>
      <input type="number" class="electroSignal1" value="0.94" placeholder="Enter electrochemical signal">
    </div>
  </div>

  <!-- Row 2 -->
  <div class="input-row">
    <div class="input-group">
      <label for="ambientTemp2">Ambient Temperature (°C)</label>
      <input type="number" class="ambientTemp2" value="21.70" placeholder="Enter ambient temperature">
    </div>
    <div class="input-group">
      <label for="soilTemp2">Soil Temperature (°C)</label>
      <input type="number" class="soilTemp2" value="18.68" placeholder="Enter soil temperature">
    </div>
    <div class="input-group">
      <label for="humidity2">Humidity (%)</label>
      <input type="number" class="humidity2" value="63.94" placeholder="Enter humidity">
    </div>
    <div class="input-group">
      <label for="lightIntensity2">Light Intensity</label>
      <input type="number" class="lightIntensity2" value="596.13" placeholder="Enter light intensity">
    </div>
    <div class="input-group">
      <label for="chlorophyll2">Chlorophyll Content</label>
      <input type="number" class="chlorophyll2" value="27.99" placeholder="Enter Chlorophyll content">
    </div>
    <div class="input-group">
      <label for="electroSignal2">Electrochemical Signal</label>
      <input type="number" class="electroSignal2" value="0.16" placeholder="Enter electrochemical signal">
    </div>
  </div>

  <!-- Row 3 -->
  <div class="input-row">
    <div class="input-group">
      <label for="ambientTemp3">Ambient Temperature (°C)</label>
      <input type="number" class="ambientTemp3" value="21.70" placeholder="Enter ambient temperature">
    </div>
    <div class="input-group">
      <label for="soilTemp3">Soil Temperature (°C)</label>
      <input type="number" class="soilTemp3" value="18.68" placeholder="Enter soil temperature">
    </div>
    <div class="input-group">
      <label for="humidity3">Humidity (%)</label>
      <input type="number" class="humidity3" value="63.94" placeholder="Enter humidity">
    </div>
    <div class="input-group">
      <label for="lightIntensity3">Light Intensity</label>
      <input type="number" class="lightIntensity3" value="596.13" placeholder="Enter light intensity">
    </div>
    <div class="input-group">
      <label for="chlorophyll3">Chlorophyll Content</label>
      <input type="number" class="chlorophyll3" value="27.99" placeholder="Enter Chlorophyll content">
    </div>
    <div class="input-group">
      <label for="electroSignal3">Electrochemical Signal</label>
      <input type="number" class="electroSignal3" value="0.16" placeholder="Enter electrochemical signal">
    </div>
  </div>

  <!-- Row 4 -->
  <div class="input-row">
    <div class="input-group">
      <label for="ambientTemp4">Ambient Temperature (°C)</label>
      <input type="number" class="ambientTemp4" value="21.70" placeholder="Enter ambient temperature">
    </div>
    <div class="input-group">
      <label for="soilTemp4">Soil Temperature (°C)</label>
      <input type="number" class="soilTemp4" value="18.68" placeholder="Enter soil temperature">
    </div>
    <div class="input-group">
      <label for="humidity4">Humidity (%)</label>
      <input type="number" class="humidity4" value="63.94" placeholder="Enter humidity">
    </div>
    <div class="input-group">
      <label for="lightIntensity4">Light Intensity</label>
      <input type="number" class="lightIntensity4" value="596.13" placeholder="Enter light intensity">
    </div>
    <div class="input-group">
      <label for="chlorophyll4">Chlorophyll Content</label>
      <input type="number" class="chlorophyll4" value="27.99" placeholder="Enter Chlorophyll content">
    </div>
    <div class="input-group">
      <label for="electroSignal4">Electrochemical Signal</label>
      <input type="number" class="electroSignal4" value="0.16" placeholder="Enter electrochemical signal">
    </div>
  </div>

  <!-- Row 5 -->
  <div class="input-row">
    <div class="input-group">
      <label for="ambientTemp5">Ambient Temperature (°C)</label>
      <input type="number" class="ambientTemp5" value="21.70" placeholder="Enter ambient temperature">
    </div>
    <div class="input-group">
      <label for="soilTemp5">Soil Temperature (°C)</label>
      <input type="number" class="soilTemp5" value="18.68" placeholder="Enter soil temperature">
    </div>
    <div class="input-group">
      <label for="humidity5">Humidity (%)</label>
      <input type="number" class="humidity5" value="63.94" placeholder="Enter humidity">
    </div>
    <div class="input-group">
      <label for="lightIntensity5">Light Intensity</label>
      <input type="number" class="lightIntensity5" value="596.13" placeholder="Enter light intensity">
    </div>
    <div class="input-group">
      <label for="chlorophyll5">Chlorophyll Content</label>
      <input type="number" class="chlorophyll5" value="27.99" placeholder="Enter Chlorophyll content">
    </div>
    <div class="input-group">
      <label for="electroSignal5">Electrochemical Signal</label>
      <input type="number" class="electroSignal5" value="0.16" placeholder="Enter electrochemical signal">
    </div>
  </div>
</main>

<button type="submit">Submit</button>

<div class="result-area" id="result">
  Result will appear here after submission.
</div>

<script>
  // Check connection to Flask server on page load
  fetch('http://localhost:5000/')
    .then(response => {
      if (response.ok) {
        console.log("✅ Connected to Flask server successfully.");
      } else {
        console.log("⚠️ Unable to connect to Flask server.");
      }
    })
    .catch(error => {
      console.log("❌ Connection to Flask server failed:", error);
    });

  // Submit button event listener
  document.querySelector("button[type=submit]").addEventListener("click", function() {
    const inputData = [];

    for (let i = 1; i <= 5; i++) {
      const ambientTemp = parseFloat(document.querySelector(`.ambientTemp${i}`).value);
      const soilTemp = parseFloat(document.querySelector(`.soilTemp${i}`).value);
      const humidity = parseFloat(document.querySelector(`.humidity${i}`).value);
      const lightIntensity = parseFloat(document.querySelector(`.lightIntensity${i}`).value);
      const chlorophyll = parseFloat(document.querySelector(`.chlorophyll${i}`).value);
      const electroSignal = parseFloat(document.querySelector(`.electroSignal${i}`).value);

      if (
        isNaN(ambientTemp) || isNaN(soilTemp) || isNaN(humidity) ||
        isNaN(lightIntensity) || isNaN(chlorophyll) || isNaN(electroSignal)
      ) {
        document.getElementById("result").textContent = "Please fill in all fields for all 5 timesteps.";
        return;
      }

      inputData.push([ambientTemp, soilTemp, humidity, lightIntensity, chlorophyll, electroSignal]);
    }

    // Debugging: Log the inputData being sent
    console.log("Sending input data:", inputData);

    fetch('http://127.0.0.1:5000/predict', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ input: inputData })
    })
    .then(response => {
      console.log("Raw response:", response);
      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      console.log('Prediction Data:', data);
      if (data.error) {
        document.getElementById("result").textContent = `Error: ${data.error}`;
      } else {
        document.getElementById("result").textContent = `Prediction: ${data["Predicted Output"].map(v => v.toFixed(2)).join(", ")}`;
      }
    })
    .catch(error => {
      console.error('❌ Request failed:', error);
      document.getElementById("result").textContent = `Request failed: ${error.message}`;
    });
  });
</script>

</body>
</html>
